name: javascript API client generation using api.yaml

#on:
 # push:
  #  paths:
   #   - daemon/api/api.yaml
on:  workflow_dispatch

jobs:
  generate-javascript-client:
    runs-on: ubuntu-latest

    name: generate javascript client
    steps:
      - uses: openapi-generators/openapitools-generator-action@v1.5.0
        with:
          generator: javascript
          openapi-url: https://raw.githubusercontent.com/opensvc/om3/main/daemon/api/api.yaml

      - uses: actions/checkout@v4
        with:
          repository: remimendes/testOpenApiGen
          path: testOpenApiGen
          sparse-checkout: |
            .git
          sparse-checkout-cone-mode: false

      - run: | 
         cp -r javascript-client/* testOpenApiGen/
         cd testOpenApiGen
         git checkout -b feature-branch
         git commit -a -m "msg"
         git push origin feature-branch
         git config --global user.email "you@example.com"
         git config --global user.name "Your Name"
         gh pr create --title "some title" --body "some body" --head "feature-branch" --base main

